write.table(integrtStrctSensPert,"DNF_CTRP.xls",sep = "\t")
write.table(integrtStrctSensPert,"DNF_CTRP.xls",sep = "\t",col.names = T,row.names = T)
View(integrtStrctSensPert)
write.table(integrtStrctSensPert,"DNF_CTRP.xls",sep = "\t",col.names = T,row.names = T)
class(integrtStrctSensPert)
head(as.data.frame(integrtStrctSensPert))
write.table(as.data.frame(integrtStrctSensPert),"DNF_CTRP.xls",sep = "\t",col.names = T,row.names = T)
write.table(as.data.frame(integrtStrctSensPert),"DNF_CTRP.xls",sep = "\t",col.names = T,row.names = T)
write.table(integrtStrctSensPert,file="DNF_CTRP.xls",sep = "\t")
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/integrationSimilarityMat-ctrpv2.RData")
write.table(integrtStrctSensPert,file="DNF_CTRP.xls",sep = "\t")
rm(integrtStrctSensPert)
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/integrationSimilarityMat-nci60.RData")
write.table(integrtStrctSensPert,file="DNF_NCI60.xls",sep = "\t")
rm(integrtStrctSensPert)
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/strcSimilarityMat-nci60.RData")
write.table(strcAffMat,file="NCI60_Structure.xls",sep = "\t")
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/sensSimilarityMat-nci60.RData")
write.table(sensAffMat,file="NCI60_Sensitivity.xls",sep = "\t")
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/pertSimilarityMat-nci60.RData")
write.table(pertAffMat,file="NCI60_Perturbation.xls",sep = "\t")
rm(pertAffMat)
rm(sensAffMat)
rm(strcAffMat)
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/strcSimilarityMat-ctrpv2.RData")
write.table(strcAffMat,file="CTRP_Structure.xls",sep = "\t")
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/sensSimilarityMat-ctrpv2.RData")
write.table(sensAffMat,file="CTRP_Sensitivity.xls",sep = "\t")
write.table(sensAffMat,file="CTRP_Sensitivity.xls",sep = "\t")
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/pertSimilarityMat-ctrpv2.RData")
write.table(pertAffMat,file="CTRP_Perturbation.xls",sep = "\t")
q()
mat <- matrix(data = rexp(200, rate = 10), nrow = 10, ncol = 20)
mat2 <- matrix(data = rexp(600, rate = 10), nrow = 10, ncol = 20)
View(mat)
View(mat2)
cor(mat,mat2)
dim(cor(mat,mat2))
dim(mat)
dim(mat2)
View(cor(mat,mat2))
cor.test(mat,mat2)
cor.test(mat,mat2,method = "spearman")
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/pertSimilarityMat-ctrpv2.RData")
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/pertSimilarityMat-nci60.RData")
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/sensSimilarityMat-ctrpv2.RData")
cor.test(pertAffMat,sensAffMat,method = "spearman")
dim(pertAffMat)
dim(sensAffMat)
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/sensSimilarityMat-ctrpv2.RData")
dim(sensAffMat)
load("/Users/DeenaGendoo/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/sensSimilarityMat-nci60.RData")
dim(sensAffMat)
cor.test(pertAffMat,sensAffMat,method = "spearman")
cor.test(pertAffMat,sensAffMat,method = "spearman")$rho
cor.test(pertAffMat,sensAffMat,method = "spearman")
grep("rho",cor.test(pertAffMat,sensAffMat,method = "spearman"))
("rho",cor.test(pertAffMat,sensAffMat,method = "spearman")[8]
cor.test(pertAffMat,sensAffMat,method = "spearman")[[8]]
cor.test(pertAffMat,sensAffMat,method = "spearman")[8]
str(cor.test(pertAffMat,sensAffMat,method = "spearman"),3)
cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
#load Structure Affinity Matrix
load("strcSimilarityMat-ctrpv2.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-ctrpv2.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-ctrpv2.RData")
cor.test(strcAffMat,sensAffMat,method = "spearman")$estimate
cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
cor.test(strcAffMat,pertAffMat,method = "spearman")$estimate
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
Pert.Vs.Sens
Pert.Vs.Sens$rho
Pert.Vs.Sens[1]
Pert.Vs.Sens
class(Pert.Vs.Sens)
unlist(Pert.Vs.Sens)
Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman")$estimate
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman")$estimate
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
Cors
barplot(cors)
barplot(cors)
barplot(Cors)
cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
cor.test(sensAffMat,pertAffMat,method = "spearman")$estimate
names(Cors)
Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(Cors)<-c("Structure vs Perturbation","Structure vs Sensitivity","Perturbation vs Sensitivity")
barplot(Cors,col = "#78c679")
barplot(Cors,col = "#78c679",las=2)
Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
barplot(Cors,col = "#78c679",las=2)
CTRPv2_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(CTRPv2_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
barplot(CTRPv2_Cors,col = "#78c679",las=2)
dev.off()
#load Structure Affinity Matrix
load("strcSimilarityMat-nci60.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-nci60.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-nci60.RData")
NCI60_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(NCI60_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman")$estimate
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman")$estimate
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
NCI60_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(NCI60_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
barplot(CTRPv2_Cors,col = "#fc8d59",las=2)
barplot(NCI60_Cors,col = "#fc8d59",las=2)
barplot(NCI60_Cors,col = "#fee08b",las=2)
dev.off()
#CTRPv2-based DNF
################################
#load Structure Affinity Matrix
load("strcSimilarityMat-ctrpv2.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-ctrpv2.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-ctrpv2.RData")
#compute correlations between pairs of data types
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman")$estimate
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman")$estimate
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
CTRPv2_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(CTRPv2_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2)
#NCI60-based DNF
################################
#load Structure Affinity Matrix
load("strcSimilarityMat-nci60.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-nci60.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-nci60.RData")
#compute correlations between pairs of data types
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman")$estimate
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman")$estimate
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
NCI60_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(NCI60_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
barplot(NCI60_Cors,col = "#fee08b",las=2)
quartz()
par(mfrow=c(1,2))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2)
barplot(NCI60_Cors,col = "#fee08b",las=2)
quartz()
par(mfrow=c(1,2))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2")
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60")
pdf("CorrelationBetweenSingleLayers.pdf",height = 10)
par(mfrow=c(1,2))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2")
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60")
dev.off()
pdf("CorrelationBetweenSingleLayers.pdf",height = 7)
par(mfrow=c(1,2),mar=c(5.1,4.1,4.1,2.1))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2")
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60")
dev.off()
pdf("CorrelationBetweenSingleLayers.pdf")
par(mfrow=c(1,2),mai=c(1.02,0.82,0.82,0.42))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2")
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60")
dev.off()
pdf("CorrelationBetweenSingleLayers.pdf")
par(mfrow=c(1,2),mai=c(0.82,0.82,0.82,0.82))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2")
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60")
dev.off()
pdf("CorrelationBetweenSingleLayers.pdf")
par(mfrow=c(1,2),mai=c(0.82,1.82,0.82,0.82))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2")
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60")
dev.off()
pdf("CorrelationBetweenSingleLayers.pdf")
par(mfrow=c(1,2),mai=c(0.82,0.82,1.82,0.82))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2")
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60")
dev.off()
pdf("CorrelationBetweenSingleLayers.pdf")
par(mfrow=c(1,2),mai=c(0.82,0.82,0.82,1.82))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2")
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60")
dev.off()
pdf("CorrelationBetweenSingleLayers.pdf")
par(mfrow=c(1,2),mai=c(1.82,0.82,0.82,0.82))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2")
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60")
dev.off()
pdf("CorrelationBetweenSingleLayers.pdf")
par(mfrow=c(1,2),mai=c(1.82,0.82,0.82,0.82))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2")
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60")
dev.off()
#CTRPv2-based DNF
################################
#load Structure Affinity Matrix
load("strcSimilarityMat-ctrpv2.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-ctrpv2.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-ctrpv2.RData")
#compute correlations between pairs of data types
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman")$estimate
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman")$estimate
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
CTRPv2_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(CTRPv2_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,ylim=c(0,1))
#NCI60-based DNF
################################
#load Structure Affinity Matrix
load("strcSimilarityMat-nci60.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-nci60.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-nci60.RData")
#compute correlations between pairs of data types
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman")$estimate
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman")$estimate
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
NCI60_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(NCI60_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
barplot(NCI60_Cors,col = "#fee08b",las=2,ylim=c(0,1))
par(mfrow=c(1,2),mai=c(1.82,0.82,0.82,0.82))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2",ylab = "Spearman Correlation",ylim=c(0,1))
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60",ylab = "Spearman Correlation",ylim=c(0,1))
source('~/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/CorrelationBetweenDataTypes.R')
################################
#load Structure Affinity Matrix
load("strcSimilarityMat-ctrpv2.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-ctrpv2.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-ctrpv2.RData")
#compute correlations between pairs of data types
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman")$estimate
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman")$estimate
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
CTRPv2_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(CTRPv2_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
CTRPv2_Cors
#load Structure Affinity Matrix
load("strcSimilarityMat-nci60.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-nci60.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-nci60.RData")
#compute correlations between pairs of data types
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman")$estimate
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman")$estimate
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman")$estimate
NCI60_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(NCI60_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
NCI60_Cors
#CTRPv2-based DNF
################################
#load Structure Affinity Matrix
load("strcSimilarityMat-ctrpv2.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-ctrpv2.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-ctrpv2.RData")
#compute correlations between pairs of data types
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman",alternative = "two.sided")$estimate
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman",alternative = "two.sided")$estimate
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman",alternative = "two.sided")$estimate
CTRPv2_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(CTRPv2_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,ylim=c(0,1))
CTRPv2_Cors
################################
#load Structure Affinity Matrix
load("strcSimilarityMat-nci60.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-nci60.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-nci60.RData")
#compute correlations between pairs of data types
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman",alternative = "two.sided")$estimate
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman",alternative = "two.sided")$estimate
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman",alternative = "two.sided")$estimate
NCI60_Cors<-c(Struct.Vs.Pert,Struct.Vs.Sens,Pert.Vs.Sens)
names(NCI60_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
NCI60_Cors
source('~/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/CorrelationBetweenDataTypes.R')
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman",alternative = "two.sided")$estimate
cor.test(pertAffMat,sensAffMat,method = "spearman",alternative = "two.sided")
str(cor.test(pertAffMat,sensAffMat,method = "spearman",alternative = "two.sided"),3)
bp<-barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,ylim=c(0,1))
bp
CTRPv2_Cors
text(x=bp,labels = c("1","2","3"))
text(x=bp,labels = c("1","2","3"))
class()
class(bp)
bp<-matrix(ncol = 1,nrow = 3)
bp
bp<-c(1,2,3)
bp
bp<-matrix(1,2,3)
bp
bp<-matrix(ncol = 1,nrow = 3)
bp[1]
bp[1]<-1
bp[2]<-1
bp[3]<-1
bp
text(x=bp,labels = c("1","2","3"))
bp<-matrix(ncol = 1,nrow = 3)
bp[1]<-bp[2]<-bp[3]<-0.2
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman",alternative = "two.sided")
Struct.Vs.Sens$estimate
Struct.Vs.Sens$p.value
bp<-matrix(ncol = 1,nrow = 3)
bp[1]<-bp[2]<-bp[3]<-0.2
#CTRPv2-based DNF
################################
#load Structure Affinity Matrix
load("strcSimilarityMat-ctrpv2.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-ctrpv2.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-ctrpv2.RData")
#compute correlations between pairs of data types
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman",alternative = "two.sided")
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman",alternative = "two.sided")
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman",alternative = "two.sided")
CTRPv2_Cors<-c(Struct.Vs.Pert$estimate,Struct.Vs.Sens$estimate,Pert.Vs.Sens$estimate)
names(CTRPv2_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
CTRPv2_PVals<-c(Struct.Vs.Pert$p.value,Struct.Vs.Sens$p.value,Pert.Vs.Sens$p.value)
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,ylim=c(0,1))
text(bp,labels = CTRPv2_PVals)
Struct.Vs.Pert$p.value
round(Struct.Vs.Pert$p.value,2)
round(Struct.Vs.Pert$p.value)
(Struct.Vs.Pert$p.value
)
prettyNum(Struct.Vs.Pert$p.value,digits=4)
prettyNum(Struct.Vs.Pert$p.value,digits=3)
bp<-matrix(ncol = 1,nrow = 3)
bp[1]<-bp[2]<-bp[3]<-0.2
#CTRPv2-based DNF
################################
#load Structure Affinity Matrix
load("strcSimilarityMat-ctrpv2.RData")
#load Sensitivity Affinity Matrix
load("sensSimilarityMat-ctrpv2.RData")
#load Perturbation Affinity Matrix
load("pertSimilarityMat-ctrpv2.RData")
#compute correlations between pairs of data types
# Structure-Sensitivity
Struct.Vs.Sens<-cor.test(strcAffMat,sensAffMat,method = "spearman",alternative = "two.sided")
# Structure - Perturbation
Struct.Vs.Pert<-cor.test(strcAffMat,pertAffMat,method = "spearman",alternative = "two.sided")
# Perturbation - Sensitivity
Pert.Vs.Sens<-cor.test(pertAffMat,sensAffMat,method = "spearman",alternative = "two.sided")
CTRPv2_Cors<-c(Struct.Vs.Pert$estimate,Struct.Vs.Sens$estimate,Pert.Vs.Sens$estimate)
names(CTRPv2_Cors)<-c("Struct vs Pert","Struct vs Sens","Pert vs Sens")
CTRPv2_PVals<-c(prettyNum(Struct.Vs.Pert$p.value,digits=3),prettyNum(Struct.Vs.Sens$p.value,digits=3),prettyNum(Pert.Vs.Sens$p.value,digits=3))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,ylim=c(0,1))
text(bp,labels = CTRPv2_PVals)
bp<-matrix(ncol = 1,nrow = 3)
bp[1]<-bp[2]<-bp[3]<-0.1
text(bp,labels = CTRPv2_PVals)
bp[1]<-bp[2]<-bp[3]<-0.15
text(bp,labels = CTRPv2_PVals)
source('~/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/CorrelationBetweenDataTypes.R')
# Plot all Correlations For Both DNF taxonomies
pdf("CorrelationBetweenSingleLayers.pdf",width = 10)
par(mfrow=c(1,2),mai=c(1.82,0.82,0.82,0.82))
barplot(CTRPv2_Cors,col = "#d9ef8b",las=2,main="CTRPv2",ylab = "Spearman Correlation",ylim=c(0,1))
text(bp,labels = CTRPv2_PVals)
barplot(NCI60_Cors,col = "#fee08b",las=2,main="NCI60",ylab = "Spearman Correlation",ylim=c(0,1))
text(bp,labels = NCI60_PVals,las=2)
dev.off()
source('~/Desktop/drugSNF/THE_FINAL_NewerBenchmarks_OlderDrugPertSignatures/Similarity_Matrices_Data/CorrelationBetweenDataTypes.R')
